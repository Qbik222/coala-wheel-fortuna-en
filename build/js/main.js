"use strict";

document.addEventListener("DOMContentLoaded", function () {
  var days = document.querySelectorAll(".wheel__days-item");
  var popupDays = document.querySelectorAll(".popup__days-item");
  var popupDaysMob = document.querySelectorAll(".days__item");
  var currentDay = 5;
  function setDays(days, currentDay) {
    days.forEach(function (day, i) {
      ++i;
      day.classList.toggle("next", i > currentDay);
      day.classList.toggle("past", i < currentDay);
      day.classList.toggle("active", i === currentDay);
    });
  }
  function daysRemind(days, classAnim) {
    var delay = 900;
    days.forEach(function (day, i) {
      setTimeout(function () {
        day.classList.add(classAnim);
        setTimeout(function () {
          return day.classList.remove(classAnim);
        }, 1200);
      }, delay * i);
    });
  }
  var randomInterval = Math.random() * (20000 - 10000) + 10000;
  function startRandomInterval() {
    var randomInterval = Math.random() * (20000 - 10000) + 10000; // Випадковий інтервал між 10 і 20 секундами
    daysRemind(days, "remind");
    daysRemind(popupDays, "remind");
    daysRemind(popupDaysMob, "remind");
    setTimeout(startRandomInterval, randomInterval);
  }
  startRandomInterval();
  daysRemind(days, "remind");
  setDays(days, currentDay);
  setDays(popupDays, currentDay);
  setDays(popupDaysMob, currentDay);
  // addAnimationClass()

  /// wheel logic
  var wheelSections = document.querySelector(".wheel__sections");
  var wheelWrap = document.querySelector(".wheel__wrap");
  var wheelArrow = document.querySelector(".wheel__arrow");
  var wheelBtn = document.querySelector(".wheel__btn");
  var spinBg = document.querySelector(".spin-bg");
  var salut = document.querySelector(".fireworks-wrap");
  var bubleBtn = document.querySelector(".wheel__days-icons");
  var wheelBuble = document.querySelector(".wheel__buble");
  var popupContainer = document.querySelector(".popups");
  var popup = document.querySelector(".popup");
  var popupCloseBtn = document.querySelector(".popup__close");
  bubleBtn.addEventListener("click", function (e) {
    wheelBuble.classList.toggle("_hidden");
    document.addEventListener("click", function (e) {
      if (e.target !== bubleBtn) wheelBuble.classList.add("_hidden");
    });
  });
  var prizes = ['iphone', 'ecoflow', 'merch', 'nothing', "bonuses"];
  function getRandomPrize(arr) {
    return arr[Math.floor(Math.random() * prizes.length)];
  }
  function showPopup(sections, wheel, showClass, currentDay, spinBg, closeBtn, popupContainer, popup) {
    popup.classList.add("".concat(showClass));
    currentDay === 7 ? popup.classList.add("_done") : popup.classList.add("_incomplete");
    popupContainer.classList.add("_opacity", "_zIndex");
    document.body.style.overflow = "hidden";
    spinBg.classList.remove("showSpinBg");
    var pers = document.querySelectorAll(".popup__pers");
    var prize = document.querySelectorAll(".popup__prize");
    var buble = document.querySelectorAll(".popup__buble");
    var popupBody = document.querySelector(".popup__main");
    var popupTitle = document.querySelectorAll(".popup__title");
    var popupLeftArrow = document.querySelectorAll(".popup__decor-left");
    var popupRightArrow = document.querySelectorAll(".popup__decor-right");
    currentDay === 7 ? popupBody.classList.add("_done") : popup.classList.add("_incomplete");
    function addAnim(arr, classAnim) {
      arr.forEach(function (item) {
        return item.classList.add("".concat(classAnim));
      });
    }

    //popup animations
    popupBody.classList.add("popupMainAnim");
    setTimeout(function () {
      addAnim(pers, "popupPersAnim");
      addAnim(buble, "popupBubleAnim");
    }, 600);
    setTimeout(function () {
      return addAnim(prize, "popupPrizeAnim");
    }, 1200);
    setTimeout(function () {
      return popupTitle.forEach(function (item) {
        return item.classList.add("popupTitleAnim");
      });
    }, 1800);
    setTimeout(function () {
      return popupLeftArrow.forEach(function (item) {
        return item.classList.add("popupLeftArrAnim");
      });
    }, 2400);
    setTimeout(function () {
      return popupRightArrow.forEach(function (item) {
        return item.classList.add("popupRightArrAnim");
      });
    }, 2700);

    //popup animations

    closeBtn.addEventListener("click", function () {
      wheel.classList.add("_lock");
      wheel.classList.remove("wheelSizeIncrease");
      document.body.style.overflow = "auto";
      popupContainer.classList.remove("_opacity", "_zIndex");
      popup.classList.remove("".concat(showClass), '_done', '_incomplete');
    });
  }
  function spinWheel(position, animation, sections, btn, wheel, arrow, prize, spinBg, salut) {
    sections.addEventListener("animationend", function () {
      sections.style.transform = "translate(-50%, -50%) rotate(".concat(position, "deg)");
      console.log(prize);
    }, {
      once: true
    });
    sections.classList.add("".concat(animation));
    arrow.style.opacity = "0";
    wheel.classList.add("wheelSizeIncrease");
    spinBg.classList.add("showSpinBg");
    salut.classList.add("_opacity");
    btn.style.pointerEvents = "none";
  }
  function firstSpin(sections, btn, wheel, arrow, prize, spinBg, salut) {
    btn.addEventListener("click", function () {
      if (prize === "iphone") {
        sections.addEventListener("animationend", function () {
          return showPopup(sections, wheel, "_iphone", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
        });
        spinWheel(1800, "iphonePrize", sections, btn, wheel, arrow, prize, spinBg, salut);
      }
      if (prize === "ecoflow") {
        sections.addEventListener("animationend", function () {
          return showPopup(sections, wheel, "_ecoflow", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
        });
        spinWheel(1665, "ecoflowPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
      }
      if (prize === "merch") {
        sections.addEventListener("animationend", function () {
          return showPopup(sections, wheel, "_merch", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
        });
        spinWheel(1711, "merchPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
      }
      if (prize === "nothing") {
        sections.addEventListener("animationend", function () {
          return showPopup(sections, wheel, "_nothing", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
        });
        spinWheel(1755, "nothingPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
      }
      if (prize === "bonuses") {
        sections.addEventListener("animationend", function () {
          return showPopup(sections, wheel, "_bonus", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
        });
        spinWheel(1935, "bonusesPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
      }
    });
  }
  firstSpin(wheelSections, wheelBtn, wheelWrap, wheelArrow, getRandomPrize(prizes), spinBg, salut);

  //// accordion

  var accordionHeaders = document.querySelectorAll('.accordion__header');
  accordionHeaders.forEach(function (header) {
    header.addEventListener('click', function () {
      var content = header.nextElementSibling;
      document.querySelectorAll('.accordion__content').forEach(function (item) {
        if (item !== content) {
          item.style.display = 'none';
          item.previousElementSibling.classList.remove('open');
        }
      });
      if (content.style.display === 'block') {
        content.style.display = 'none';
        header.classList.remove('open');
      } else {
        content.style.display = 'block';
        header.classList.add('open');
      }
    });
  });

  //// for test

  var btnsWrap = document.querySelector('.btns-wrap');
  var buttons = btnsWrap.querySelectorAll('button');
  var dropIphoneButton = document.querySelector('.drop-iphone');
  var dropEcoflowButton = document.querySelector('.drop-ecoflow');
  var dropNothingButton = document.querySelector('.drop-nothing');
  var dropMerchButton = document.querySelector('.drop-merch');
  var dropBonusButton = document.querySelector('.drop-bonus');
  var dropDone = document.querySelector('.drop-done');
  var dropLock = document.querySelector('.drop-lock');
  // const dropIncomplete = document.querySelector('.drop-incomplete');
  var dropMenu = document.querySelector('.drop-menu');
  dropMenu.addEventListener("click", function () {
    return btnsWrap.classList.toggle("_hidden");
  });
  firstSpin(wheelSections, dropIphoneButton, wheelWrap, wheelArrow, "iphone", spinBg, salut);
  firstSpin(wheelSections, dropEcoflowButton, wheelWrap, wheelArrow, "ecoflow", spinBg, salut);
  firstSpin(wheelSections, dropNothingButton, wheelWrap, wheelArrow, "nothing", spinBg, salut);
  firstSpin(wheelSections, dropMerchButton, wheelWrap, wheelArrow, "merch", spinBg, salut);
  firstSpin(wheelSections, dropBonusButton, wheelWrap, wheelArrow, "bonuses", spinBg, salut);
  buttons.forEach(function (item) {
    item.addEventListener("click", function () {
      wheelSections.style.animationDuration = "0.1s";
      wheelSections.addEventListener("animationend", function () {
        wheelSections.style.animationDuration = "8s";
      });
    });
  });
  dropLock.addEventListener("click", function () {
    return wheelWrap.classList.toggle("_lock");
  });
  dropDone.addEventListener("click", function () {
    return currentDay = 7;
  });
  // localStorage.setItem(currentDay, currentDay)
  // dropIncomplete.addEventListener("click", () => currentDay = 3)
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZGF5cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwb3B1cERheXMiLCJwb3B1cERheXNNb2IiLCJjdXJyZW50RGF5Iiwic2V0RGF5cyIsImZvckVhY2giLCJkYXkiLCJpIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZGF5c1JlbWluZCIsImNsYXNzQW5pbSIsImRlbGF5Iiwic2V0VGltZW91dCIsImFkZCIsInJlbW92ZSIsInJhbmRvbUludGVydmFsIiwiTWF0aCIsInJhbmRvbSIsInN0YXJ0UmFuZG9tSW50ZXJ2YWwiLCJ3aGVlbFNlY3Rpb25zIiwicXVlcnlTZWxlY3RvciIsIndoZWVsV3JhcCIsIndoZWVsQXJyb3ciLCJ3aGVlbEJ0biIsInNwaW5CZyIsInNhbHV0IiwiYnVibGVCdG4iLCJ3aGVlbEJ1YmxlIiwicG9wdXBDb250YWluZXIiLCJwb3B1cCIsInBvcHVwQ2xvc2VCdG4iLCJlIiwidGFyZ2V0IiwicHJpemVzIiwiZ2V0UmFuZG9tUHJpemUiLCJhcnIiLCJmbG9vciIsImxlbmd0aCIsInNob3dQb3B1cCIsInNlY3Rpb25zIiwid2hlZWwiLCJzaG93Q2xhc3MiLCJjbG9zZUJ0biIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93IiwicGVycyIsInByaXplIiwiYnVibGUiLCJwb3B1cEJvZHkiLCJwb3B1cFRpdGxlIiwicG9wdXBMZWZ0QXJyb3ciLCJwb3B1cFJpZ2h0QXJyb3ciLCJhZGRBbmltIiwiaXRlbSIsInNwaW5XaGVlbCIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiYnRuIiwiYXJyb3ciLCJ0cmFuc2Zvcm0iLCJjb25zb2xlIiwibG9nIiwib25jZSIsIm9wYWNpdHkiLCJwb2ludGVyRXZlbnRzIiwiZmlyc3RTcGluIiwiYWNjb3JkaW9uSGVhZGVycyIsImhlYWRlciIsImNvbnRlbnQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJkaXNwbGF5IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImJ0bnNXcmFwIiwiYnV0dG9ucyIsImRyb3BJcGhvbmVCdXR0b24iLCJkcm9wRWNvZmxvd0J1dHRvbiIsImRyb3BOb3RoaW5nQnV0dG9uIiwiZHJvcE1lcmNoQnV0dG9uIiwiZHJvcEJvbnVzQnV0dG9uIiwiZHJvcERvbmUiLCJkcm9wTG9jayIsImRyb3BNZW51IiwiYW5pbWF0aW9uRHVyYXRpb24iXSwibWFwcGluZ3MiOiI7O0FBQUFBLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsWUFBSztFQUMvQyxJQUFNQyxJQUFJLEdBQUdGLFFBQVEsQ0FBQ0csZ0JBQWdCLENBQUMsbUJBQW1CLENBQUM7RUFDM0QsSUFBTUMsU0FBUyxHQUFHSixRQUFRLENBQUNHLGdCQUFnQixDQUFDLG1CQUFtQixDQUFDO0VBQ2hFLElBQU1FLFlBQVksR0FBR0wsUUFBUSxDQUFDRyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUM7RUFDN0QsSUFBSUcsVUFBVSxHQUFHLENBQUM7RUFFbEIsU0FBU0MsT0FBTyxDQUFDTCxJQUFJLEVBQUVJLFVBQVUsRUFBQztJQUM5QkosSUFBSSxDQUFDTSxPQUFPLENBQUMsVUFBQ0MsR0FBRyxFQUFFQyxDQUFDLEVBQUk7TUFDcEIsRUFBRUEsQ0FBQztNQUNIRCxHQUFHLENBQUNFLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLE1BQU0sRUFBRUYsQ0FBQyxHQUFHSixVQUFVLENBQUM7TUFDNUNHLEdBQUcsQ0FBQ0UsU0FBUyxDQUFDQyxNQUFNLENBQUMsTUFBTSxFQUFFRixDQUFDLEdBQUdKLFVBQVUsQ0FBQztNQUM1Q0csR0FBRyxDQUFDRSxTQUFTLENBQUNDLE1BQU0sQ0FBQyxRQUFRLEVBQUVGLENBQUMsS0FBS0osVUFBVSxDQUFDO0lBQ3BELENBQUMsQ0FBQztFQUNOO0VBRUEsU0FBU08sVUFBVSxDQUFDWCxJQUFJLEVBQUVZLFNBQVMsRUFBRTtJQUNqQyxJQUFJQyxLQUFLLEdBQUcsR0FBRztJQUNmYixJQUFJLENBQUNNLE9BQU8sQ0FBQyxVQUFDQyxHQUFH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R0FBRyxDQUFDO0VBQUEsRUFBQztFQUM1RDtFQUNBO0FBRUEsQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PntcbiAgICBjb25zdCBkYXlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi53aGVlbF9fZGF5cy1pdGVtXCIpXG4gICAgY29uc3QgcG9wdXBEYXlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZGF5cy1pdGVtXCIpO1xuICAgIGNvbnN0IHBvcHVwRGF5c01vYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZGF5c19faXRlbVwiKTtcbiAgICBsZXQgY3VycmVudERheSA9IDVcblxuICAgIGZ1bmN0aW9uIHNldERheXMoZGF5cywgY3VycmVudERheSl7XG4gICAgICAgIGRheXMuZm9yRWFjaCgoZGF5LCBpKSA9PntcbiAgICAgICAgICAgICsraVxuICAgICAgICAgICAgZGF5LmNsYXNzTGlzdC50b2dnbGUoXCJuZXh0XCIsIGkgPiBjdXJyZW50RGF5KTtcbiAgICAgICAgICAgIGRheS5jbGFzc0xpc3QudG9nZ2xlKFwicGFzdFwiLCBpIDwgY3VycmVudERheSk7XG4gICAgICAgICAgICBkYXkuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiLCBpID09PSBjdXJyZW50RGF5KTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkYXlzUmVtaW5kKGRheXMsIGNsYXNzQW5pbSkge1xuICAgICAgICBsZXQgZGVsYXkgPSA5MDA7XG4gICAgICAgIGRheXMuZm9yRWFjaCgoZGF5LCBpKSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LmFkZChjbGFzc0FuaW0pO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZGF5LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NBbmltKSwgMTIwMClcbiAgICAgICAgICAgIH0sIGRlbGF5ICogaSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJhbmRvbUludGVydmFsID0gTWF0aC5yYW5kb20oKSAqICgyMDAwMCAtIDEwMDAwKSArIDEwMDAwO1xuXG5cbiAgICBmdW5jdGlvbiBzdGFydFJhbmRvbUludGVydmFsKCkge1xuICAgICAgICBjb25zdCByYW5kb21JbnRlcnZhbCA9IE1hdGgucmFuZG9tKCkgKiAoMjAwMDAgLSAxMDAwMCkgKyAxMDAwMDsgLy8g0JLQuNC/0LDQtNC60L7QstC40Lkg0ZbQvdGC0LXRgNCy0LDQuyDQvNGW0LYgMTAg0ZYgMjAg0YHQtdC60YPQvdC00LDQvNC4XG4gICAgICAgIGRheXNSZW1pbmQoZGF5cywgXCJyZW1pbmRcIik7XG4gICAgICAgIGRheXNSZW1pbmQocG9wdXBEYXlzLCBcInJlbWluZFwiKTtcbiAgICAgICAgZGF5c1JlbWluZChwb3B1cERheXNNb2IsIFwicmVtaW5kXCIpO1xuICAgICAgICBzZXRUaW1lb3V0KHN0YXJ0UmFuZG9tSW50ZXJ2YWwsIHJhbmRvbUludGVydmFsKTtcbiAgICB9XG5cbiAgICBzdGFydFJhbmRvbUludGVydmFsKCk7XG4gICAgZGF5c1JlbWluZChkYXlzLCBcInJlbWluZFwiKVxuXG4gICAgc2V0RGF5cyhkYXlzLCBjdXJyZW50RGF5KVxuICAgIHNldERheXMocG9wdXBEYXlzLCBjdXJyZW50RGF5KVxuICAgIHNldERheXMocG9wdXBEYXlzTW9iLCBjdXJyZW50RGF5KVxuLy8gYWRkQW5pbWF0aW9uQ2xhc3MoKVxuXG4vLy8gd2hlZWwgbG9naWNcbiAgICBjb25zdCB3aGVlbFNlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fc2VjdGlvbnNcIilcbiAgICBjb25zdCB3aGVlbFdyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoZWVsX193cmFwXCIpXG4gICAgY29uc3Qgd2hlZWxBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2Fycm93XCIpXG4gICAgY29uc3Qgd2hlZWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoZWVsX19idG5cIilcbiAgICBjb25zdCBzcGluQmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNwaW4tYmdcIilcbiAgICBjb25zdCBzYWx1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmlyZXdvcmtzLXdyYXBcIilcbiAgICBjb25zdCBidWJsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2RheXMtaWNvbnNcIilcbiAgICBjb25zdCB3aGVlbEJ1YmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fYnVibGVcIilcbiAgICBjb25zdCBwb3B1cENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBzXCIpXG4gICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwXCIpXG4gICAgY29uc3QgcG9wdXBDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpXG5cbiAgICBidWJsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+e1xuICAgICAgICB3aGVlbEJ1YmxlLmNsYXNzTGlzdC50b2dnbGUoXCJfaGlkZGVuXCIpXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge2lmKGUudGFyZ2V0ICE9PSBidWJsZUJ0bikgd2hlZWxCdWJsZS5jbGFzc0xpc3QuYWRkKFwiX2hpZGRlblwiKX0pXG4gICAgfSlcblxuICAgIGxldCBwcml6ZXMgPSBbJ2lwaG9uZScsICdlY29mbG93JywgJ21lcmNoJywgJ25vdGhpbmcnLCBcImJvbnVzZXNcIl1cbiAgICBmdW5jdGlvbiBnZXRSYW5kb21Qcml6ZShhcnIpIHtcbiAgICAgICAgcmV0dXJuIGFycltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwcml6ZXMubGVuZ3RoKV07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIHNob3dDbGFzcywgY3VycmVudERheSwgc3BpbkJnLCBjbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKXtcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZChgJHtzaG93Q2xhc3N9YClcbiAgICAgICAgY3VycmVudERheSA9PT0gNyA/IHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJfZG9uZVwiKSA6IHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJfaW5jb21wbGV0ZVwiKVxuICAgICAgICBwb3B1cENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiX29wYWNpdHlcIiwgXCJfekluZGV4XCIpXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiXG4gICAgICAgIHNwaW5CZy5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1NwaW5CZ1wiKVxuICAgICAgICBjb25zdCBwZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fcGVyc1wiKVxuICAgICAgICBjb25zdCBwcml6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX3ByaXplXCIpXG4gICAgICAgIGNvbnN0IGJ1YmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fYnVibGVcIilcbiAgICAgICAgY29uc3QgcG9wdXBCb2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fbWFpblwiKVxuICAgICAgICBjb25zdCBwb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fdGl0bGVcIilcbiAgICAgICAgY29uc3QgcG9wdXBMZWZ0QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19kZWNvci1sZWZ0XCIpXG4gICAgICAgIGNvbnN0IHBvcHVwUmlnaHRBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2RlY29yLXJpZ2h0XCIpXG4gICAgICAgIGN1cnJlbnREYXkgPT09IDcgPyBwb3B1cEJvZHkuY2xhc3NMaXN0LmFkZChcIl9kb25lXCIpIDogcG9wdXAuY2xhc3NMaXN0LmFkZChcIl9pbmNvbXBsZXRlXCIpXG5cbiAgICAgICAgZnVuY3Rpb24gYWRkQW5pbShhcnIsIGNsYXNzQW5pbSl7XG4gICAgICAgICAgICBhcnIuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LmFkZChgJHtjbGFzc0FuaW19YCkgKVxuICAgICAgICB9XG5cbiAgICAgICAgLy9wb3B1cCBhbmltYXRpb25zXG4gICAgICAgIHBvcHVwQm9keS5jbGFzc0xpc3QuYWRkKFwicG9wdXBNYWluQW5pbVwiKVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICAgICAgYWRkQW5pbShwZXJzLCBcInBvcHVwUGVyc0FuaW1cIilcbiAgICAgICAgICAgIGFkZEFuaW0oYnVibGUsIFwicG9wdXBCdWJsZUFuaW1cIilcbiAgICAgICAgfSwgNjAwKVxuICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiBhZGRBbmltKHByaXplLCBcInBvcHVwUHJpemVBbmltXCIpLCAxMjAwKVxuICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiBwb3B1cFRpdGxlLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJwb3B1cFRpdGxlQW5pbVwiKSksIDE4MDApXG4gICAgICAgIHNldFRpbWVvdXQoICgpID0+IHBvcHVwTGVmdEFycm93LmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJwb3B1cExlZnRBcnJBbmltXCIpKSwgMjQwMClcbiAgICAgICAgc2V0VGltZW91dCggKCkgPT4gcG9wdXBSaWdodEFycm93LmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJwb3B1cFJpZ2h0QXJyQW5pbVwiKSksIDI3MDApXG5cbiAgICAgICAgLy9wb3B1cCBhbmltYXRpb25zXG5cblxuICAgICAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgICAgICAgICB3aGVlbC5jbGFzc0xpc3QuYWRkKFwiX2xvY2tcIilcbiAgICAgICAgICAgIHdoZWVsLmNsYXNzTGlzdC5yZW1vdmUoXCJ3aGVlbFNpemVJbmNyZWFzZVwiKVxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiYXV0b1wiXG4gICAgICAgICAgICBwb3B1cENvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiX29wYWNpdHlcIiwgXCJfekluZGV4XCIpXG4gICAgICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKGAke3Nob3dDbGFzc31gLCAnX2RvbmUnLCAnX2luY29tcGxldGUnKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBmdW5jdGlvbiBzcGluV2hlZWwocG9zaXRpb24sIGFuaW1hdGlvbiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dCl7XG4gICAgICAgIHNlY3Rpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgKCkgPT57XG4gICAgICAgICAgICBzZWN0aW9ucy5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZSgke3Bvc2l0aW9ufWRlZylgXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwcml6ZSlcbiAgICAgICAgfSwge29uY2U6IHRydWV9KVxuICAgICAgICBzZWN0aW9ucy5jbGFzc0xpc3QuYWRkKGAke2FuaW1hdGlvbn1gKVxuICAgICAgICBhcnJvdy5zdHlsZS5vcGFjaXR5ID0gXCIwXCJcbiAgICAgICAgd2hlZWwuY2xhc3NMaXN0LmFkZChcIndoZWVsU2l6ZUluY3JlYXNlXCIpXG4gICAgICAgIHNwaW5CZy5jbGFzc0xpc3QuYWRkKFwic2hvd1NwaW5CZ1wiKVxuICAgICAgICBzYWx1dC5jbGFzc0xpc3QuYWRkKFwiX29wYWNpdHlcIilcbiAgICAgICAgYnRuLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpcnN0U3BpbihzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KXtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICAgICAgICAgIGlmKHByaXplID09PSBcImlwaG9uZVwiKXtcbiAgICAgICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX2lwaG9uZVwiLCBjdXJyZW50RGF5LCBzcGluQmcsIHBvcHVwQ2xvc2VCdG4sIHBvcHVwQ29udGFpbmVyLCBwb3B1cCkpXG4gICAgICAgICAgICAgICAgc3BpbldoZWVsKDE4MDAsIFwiaXBob25lUHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHByaXplID09PSBcImVjb2Zsb3dcIil7XG4gICAgICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLCBcIl9lY29mbG93XCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgICAgICBzcGluV2hlZWwoMTY2NSwgXCJlY29mbG93UHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHByaXplID09PSBcIm1lcmNoXCIpe1xuICAgICAgICAgICAgICAgIHNlY3Rpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgKCkgPT4gc2hvd1BvcHVwKHNlY3Rpb25zLCB3aGVlbCwgXCJfbWVyY2hcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgICAgIHNwaW5XaGVlbCgxNzExLCBcIm1lcmNoUHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHByaXplID09PSBcIm5vdGhpbmdcIil7XG4gICAgICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLFwiX25vdGhpbmdcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgICAgIHNwaW5XaGVlbCgxNzU1LCBcIm5vdGhpbmdQcml6ZVwiLCBzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYocHJpemUgPT09IFwiYm9udXNlc1wiKXtcbiAgICAgICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX2JvbnVzXCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgICAgICBzcGluV2hlZWwoMTkzNSwgXCJib251c2VzUHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmaXJzdFNwaW4od2hlZWxTZWN0aW9ucywgd2hlZWxCdG4sIHdoZWVsV3JhcCwgd2hlZWxBcnJvdywgZ2V0UmFuZG9tUHJpemUocHJpemVzKSwgc3BpbkJnLCBzYWx1dClcblxuXG5cblxuXG5cbi8vLy8gYWNjb3JkaW9uXG5cbiAgICBjb25zdCBhY2NvcmRpb25IZWFkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFjY29yZGlvbl9faGVhZGVyJyk7XG4gICAgYWNjb3JkaW9uSGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XG4gICAgICAgIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBoZWFkZXIubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWNjb3JkaW9uX19jb250ZW50JykuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPT0gY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoY29udGVudC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cblxuLy8vLyBmb3IgdGVzdFxuXG4gICAgY29uc3QgYnRuc1dyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRucy13cmFwJyk7XG5cbiAgICBjb25zdCBidXR0b25zID0gYnRuc1dyYXAucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJyk7XG5cbiAgICBjb25zdCBkcm9wSXBob25lQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3AtaXBob25lJyk7XG4gICAgY29uc3QgZHJvcEVjb2Zsb3dCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1lY29mbG93Jyk7XG4gICAgY29uc3QgZHJvcE5vdGhpbmdCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1ub3RoaW5nJyk7XG4gICAgY29uc3QgZHJvcE1lcmNoQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3AtbWVyY2gnKTtcbiAgICBjb25zdCBkcm9wQm9udXNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1ib251cycpO1xuICAgIGNvbnN0IGRyb3BEb25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3AtZG9uZScpO1xuICAgIGNvbnN0IGRyb3BMb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3AtbG9jaycpO1xuLy8gY29uc3QgZHJvcEluY29tcGxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1pbmNvbXBsZXRlJyk7XG4gICAgY29uc3QgZHJvcE1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1tZW51Jyk7XG5cbiAgICBkcm9wTWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCk9PiBidG5zV3JhcC5jbGFzc0xpc3QudG9nZ2xlKFwiX2hpZGRlblwiKSlcblxuICAgIGZpcnN0U3Bpbih3aGVlbFNlY3Rpb25zLCBkcm9wSXBob25lQnV0dG9uLCB3aGVlbFdyYXAsIHdoZWVsQXJyb3csIFwiaXBob25lXCIsIHNwaW5CZywgc2FsdXQpXG4gICAgZmlyc3RTcGluKHdoZWVsU2VjdGlvbnMsIGRyb3BFY29mbG93QnV0dG9uLCB3aGVlbFdyYXAsIHdoZWVsQXJyb3csIFwiZWNvZmxvd1wiLCBzcGluQmcsIHNhbHV0KVxuICAgIGZpcnN0U3Bpbih3aGVlbFNlY3Rpb25zLCBkcm9wTm90aGluZ0J1dHRvbiwgd2hlZWxXcmFwLCB3aGVlbEFycm93LCBcIm5vdGhpbmdcIiwgc3BpbkJnLCBzYWx1dClcbiAgICBmaXJzdFNwaW4od2hlZWxTZWN0aW9ucywgZHJvcE1lcmNoQnV0dG9uLCB3aGVlbFdyYXAsIHdoZWVsQXJyb3csIFwibWVyY2hcIiwgc3BpbkJnLCBzYWx1dClcbiAgICBmaXJzdFNwaW4od2hlZWxTZWN0aW9ucywgZHJvcEJvbnVzQnV0dG9uLCB3aGVlbFdyYXAsIHdoZWVsQXJyb3csIFwiYm9udXNlc1wiLCBzcGluQmcsIHNhbHV0KVxuXG4gICAgYnV0dG9ucy5mb3JFYWNoKGl0ZW0gPT57XG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHdoZWVsU2VjdGlvbnMuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBcIjAuMXNcIlxuICAgICAgICAgICAgd2hlZWxTZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+e1xuICAgICAgICAgICAgICAgIHdoZWVsU2VjdGlvbnMuc3R5bGUuYW5pbWF0aW9uRHVyYXRpb24gPSBcIjhzXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIGRyb3BMb2NrLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB3aGVlbFdyYXAuY2xhc3NMaXN0LnRvZ2dsZShcIl9sb2NrXCIpKVxuICAgIGRyb3BEb25lLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjdXJyZW50RGF5ID0gNylcbi8vIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGN1cnJlbnREYXksIGN1cnJlbnREYXkpXG4vLyBkcm9wSW5jb21wbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY3VycmVudERheSA9IDMpXG5cbn0pXG5cblxuXG5cbiJdfQ==
