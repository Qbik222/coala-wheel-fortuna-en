"use strict";

var days = document.querySelectorAll(".wheel__days-item");
var popupDays = document.querySelectorAll(".popup__days-item");
var popupDaysMob = document.querySelectorAll(".days__item");
var currentDay = 5;
function setDays(days, currentDay) {
  days.forEach(function (day, i) {
    ++i;
    day.classList.toggle("next", i > currentDay);
    day.classList.toggle("past", i < currentDay);
    day.classList.toggle("active", i === currentDay);
  });
}

// function addAnimationClass() {
//     const pastAndActive = document.querySelectorAll(".wheel__days-item.past, .wheel__days-item.active");
//     console.log(pastAndActive)
//
//     pastAndActive.forEach((item, i) => {
//         let day = item.querySelector(".wheel__days-item-text")
//         const randomDelay = Math.random() * 20000;
//
//         setTimeout(() => {
//             // console.log(day)
//             day.style.animationDelay = `${i/ 2}s`;
//             day.classList.add('daysAnim');
//             day.addEventListener("click", () =>{
//                 console.log(day)
//                 day.classList.remove('daysAnim');
//             }, {once: true})
//         }, randomDelay);
//     });
// }

setDays(days, currentDay);
setDays(popupDays, currentDay);
setDays(popupDaysMob, currentDay);
// addAnimationClass()

/// wheel logic
var wheelSections = document.querySelector(".wheel__sections");
var wheelWrap = document.querySelector(".wheel__wrap");
var wheelArrow = document.querySelector(".wheel__arrow");
var wheelBtn = document.querySelector(".wheel__btn");
var spinBg = document.querySelector(".spin-bg");
var salut = document.querySelector(".fireworks-wrap");
var bubleBtn = document.querySelector(".wheel__days-icons");
var wheelBuble = document.querySelector(".wheel__buble");
var popupContainer = document.querySelector(".popups");
var popup = document.querySelector(".popup");
var popupCloseBtn = document.querySelector(".popup__close");
bubleBtn.addEventListener("click", function (e) {
  wheelBuble.classList.toggle("_hidden");
  document.addEventListener("click", function (e) {
    if (e.target !== bubleBtn) wheelBuble.classList.add("_hidden");
  });
});
var prizes = ['iphone', 'ecoflow', 'merch', 'nothing', "bonuses"];
function getRandomPrize(arr) {
  return arr[Math.floor(Math.random() * prizes.length)];
}
function showPopup(sections, wheel, showClass, currentDay, spinBg, closeBtn, popupContainer, popup) {
  popup.classList.add("".concat(showClass));
  currentDay === 7 ? popup.classList.add("_done") : popup.classList.add("_incomplete");
  popupContainer.classList.add("_opacity", "_zIndex");
  document.body.style.overflow = "hidden";
  spinBg.classList.remove("showSpinBg");
  var pers = document.querySelectorAll(".popup__pers");
  var prize = document.querySelectorAll(".popup__prize");
  var buble = document.querySelectorAll(".popup__buble");
  var popupBody = document.querySelector(".popup__main");
  var popupTitle = document.querySelectorAll(".popup__title");
  var popupLeftArrow = document.querySelectorAll(".popup__decor-left");
  var popupRightArrow = document.querySelectorAll(".popup__decor-right");
  currentDay === 7 ? popupBody.classList.add("_done") : popup.classList.add("_incomplete");
  function addAnim(arr, classAnim) {
    arr.forEach(function (item) {
      return item.classList.add("".concat(classAnim));
    });
  }

  //popup animations
  popupBody.classList.add("popupMainAnim");
  setTimeout(function () {
    addAnim(pers, "popupPersAnim");
    addAnim(buble, "popupBubleAnim");
  }, 600);
  setTimeout(function () {
    return addAnim(prize, "popupPrizeAnim");
  }, 1200);
  setTimeout(function () {
    return popupTitle.forEach(function (item) {
      return item.classList.add("popupTitleAnim");
    });
  }, 1800);
  setTimeout(function () {
    return popupLeftArrow.forEach(function (item) {
      return item.classList.add("popupLeftArrAnim");
    });
  }, 2400);
  setTimeout(function () {
    return popupRightArrow.forEach(function (item) {
      return item.classList.add("popupRightArrAnim");
    });
  }, 2700);

  //popup animations

  closeBtn.addEventListener("click", function () {
    wheel.classList.add("_lock");
    wheel.classList.remove("wheelSizeIncrease");
    document.body.style.overflow = "auto";
    popupContainer.classList.remove("_opacity", "_zIndex");
    popup.classList.remove("".concat(showClass), '_done', '_incomplete');
  });
}
function spinWheel(position, animation, sections, btn, wheel, arrow, prize, spinBg, salut) {
  sections.addEventListener("animationend", function () {
    sections.style.transform = "translate(-50%, -50%) rotate(".concat(position, "deg)");
    console.log(prize);
  }, {
    once: true
  });
  sections.classList.add("".concat(animation));
  arrow.style.opacity = "0";
  wheel.classList.add("wheelSizeIncrease");
  spinBg.classList.add("showSpinBg");
  salut.classList.add("_opacity");
  btn.style.pointerEvents = "none";
}
function firstSpin(sections, btn, wheel, arrow, prize, spinBg, salut) {
  btn.addEventListener("click", function () {
    if (prize === "iphone") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_iphone", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1800, "iphonePrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "ecoflow") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_ecoflow", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1665, "ecoflowPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "merch") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_merch", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1711, "merchPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "nothing") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_nothing", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1755, "nothingPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "bonuses") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_bonus", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1935, "bonusesPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
  });
}
firstSpin(wheelSections, wheelBtn, wheelWrap, wheelArrow, "ecoflow", spinBg, salut);

//// accordion

var accordionHeaders = document.querySelectorAll('.accordion__header');
accordionHeaders.forEach(function (header) {
  header.addEventListener('click', function () {
    var content = header.nextElementSibling;
    document.querySelectorAll('.accordion__content').forEach(function (item) {
      if (item !== content) {
        item.style.display = 'none';
        item.previousElementSibling.classList.remove('open');
      }
    });
    if (content.style.display === 'block') {
      content.style.display = 'none';
      header.classList.remove('open');
    } else {
      content.style.display = 'block';
      header.classList.add('open');
    }
  });
});

//// for test

var btnsWrap = document.querySelector('.btns-wrap');
var buttons = btnsWrap.querySelectorAll('button');
var dropIphoneButton = document.querySelector('.drop-iphone');
var dropEcoflowButton = document.querySelector('.drop-ecoflow');
var dropNothingButton = document.querySelector('.drop-nothing');
var dropMerchButton = document.querySelector('.drop-merch');
var dropBonusButton = document.querySelector('.drop-bonus');
var dropDone = document.querySelector('.drop-done');
// const dropIncomplete = document.querySelector('.drop-incomplete');
var dropMenu = document.querySelector('.drop-menu');
dropMenu.addEventListener("click", function () {
  return btnsWrap.classList.toggle("_hidden");
});
firstSpin(wheelSections, dropIphoneButton, wheelWrap, wheelArrow, "iphone", spinBg, salut);
firstSpin(wheelSections, dropEcoflowButton, wheelWrap, wheelArrow, "ecoflow", spinBg, salut);
firstSpin(wheelSections, dropNothingButton, wheelWrap, wheelArrow, "nothing", spinBg, salut);
firstSpin(wheelSections, dropMerchButton, wheelWrap, wheelArrow, "merch", spinBg, salut);
firstSpin(wheelSections, dropBonusButton, wheelWrap, wheelArrow, "bonuses", spinBg, salut);
buttons.forEach(function (item) {
  item.addEventListener("click", function () {
    wheelSections.style.animationDuration = "0.1s";
    wheelSections.addEventListener("animationend", function () {
      wheelSections.style.animationDuration = "8s";
    });
  });
});
dropDone.addEventListener("click", function () {
  return currentDay = 7;
});
// localStorage.setItem(currentDay, currentDay)
// dropIncomplete.addEventListener("click", () => currentDay = 3)
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZGF5cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInBvcHVwRGF5cyIsInBvcHVwRGF5c01vYiIsImN1cnJlbnREYXkiLCJzZXREYXlzIiwiZm9yRWFjaCIsImRheSIsImkiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJ3aGVlbFNlY3Rpb25zIiwicXVlcnlTZWxlY3RvciIsIndoZWVsV3JhcCIsIndoZWVsQXJyb3ciLCJ3aGVlbEJ0biIsInNwaW5CZyIsInNhbHV0IiwiYnVibGVCdG4iLCJ3aGVlbEJ1YmxlIiwicG9wdXBDb250YWluZXIiLCJwb3B1cCIsInBvcHVwQ2xvc2VCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsImFkZCIsInByaXplcyIsImdldFJhbmRvbVByaXplIiwiYXJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwic2hvd1BvcHVwIiwic2VjdGlvbnMiLCJ3aGVlbCIsInNob3dDbGFzcyIsImNsb3NlQnRuIiwiYm9keSIsInN0eWxlIiwib3ZlcmZsb3ciLCJyZW1vdmUiLCJwZXJzIiwicHJpemUiLCJidWJsZSIsInBvcHVwQm9keSIsInBvcHVwVGl0bGUiLCJwb3B1cExlZnRBcnJvdyIsInBvcHVwUmlnaHRBcnJvdyIsImFkZEFuaW0iLCJjbGFzc0FuaW0iLCJpdGVtIiwic2V0VGltZW91dCIsInNwaW5XaGVlbCIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiYnRuIiwiYXJyb3ciLCJ0cmFuc2Zvcm0iLCJjb25zb2xlIiwibG9nIiwib25jZSIsIm9wYWNpdHkiLCJwb2ludGVyRXZlbnRzIiwiZmlyc3RTcGluIiwiYWNjb3JkaW9uSGVhZGVycyIsImhlYWRlciIsImNvbnRlbnQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJkaXNwbGF5IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImJ0bnNXcmFwIiwiYnV0dG9ucyIsImRyb3BJcGhvbmVCdXR0b24iLCJkcm9wRWNvZmxvd0J1dHRvbiIsImRyb3BOb3RoaW5nQnV0dG9uIiwiZHJvcE1lcmNoQnV0dG9uIiwiZHJvcEJvbnVzQnV0dG9uIiwiZHJvcERvbmUiLCJkcm9wTWVudSIsImFuaW1hdGlvbkR1cmF0aW9uIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLElBQUksR0FBR0MsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQztBQUMzRCxJQUFNQyxTQUFTLEdBQUdGLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUM7QUFDaEUsSUFBTUUsWUFBWSxHQUFHSCxRQUFRLENBQUNDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQztBQUM3RCxJQUFJRyxVQUFVLEdBQUcsQ0FBQztBQUVsQixTQUFTQyxPQUFPLENBQUNOLElBQUksRUFBRUssVUFBVSxFQUFDO0VBQzlCTCxJQUFJLENBQUNPLE9BQU8sQ0FBQyxVQUFDQyxHQUFHLEVBQUVDLENBQUMsRUFBSTtJQUNwQixFQUFFQSxDQUFDO0lBQ0hELEdBQUcsQ0FBQ0UsU0FBUyxDQUFDQyxNQUFNLENBQUMsTUFBTSxFQUFFRixDQUFDLEdBQUdKLFVBQVUsQ0FBQztJQUM1Q0csR0FBRyxDQUFDRSxTQUFTLENBQUNDLE1BQU0sQ0FBQyxNQUFNLEVBQUVGLENBQUMsR0FBR0osVUFBVSxDQUFDO0lBQzVDRyxHQUFHLENBQUNFLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDLFFBQVEsRUFBRUYsQ0FBQyxLQUFLSixVQUFVLENBQUM7RUFDcEQsQ0FBQyxDQUFDO0FBQ047O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBSUFDLE9BQU8sQ0FBQ04sSUFBSSxFQUFFSyxVQUFVLENBQUM7QUFDekJDLE9BQU8sQ0FBQ0gsU0FBUyxFQUFFRSxVQUFVLENBQUM7QUFDOUJDLE9BQU8sQ0FBQ0YsWUFBWSxFQUFFQyxVQUFVLENBQUM7QUFDakM7O0FBRUE7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Y3RvckFsbChcIi53aGVlbF9fZGF5cy1pdGVtXCIpXG5jb25zdCBwb3B1cERheXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19kYXlzLWl0ZW1cIik7XG5jb25zdCBwb3B1cERheXNNb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmRheXNfX2l0ZW1cIik7XG5sZXQgY3VycmVudERheSA9IDVcblxuZnVuY3Rpb24gc2V0RGF5cyhkYXlzLCBjdXJyZW50RGF5KXtcbiAgICBkYXlzLmZvckVhY2goKGRheSwgaSkgPT57XG4gICAgICAgICsraVxuICAgICAgICBkYXkuY2xhc3NMaXN0LnRvZ2dsZShcIm5leHRcIiwgaSA+IGN1cnJlbnREYXkpO1xuICAgICAgICBkYXkuY2xhc3NMaXN0LnRvZ2dsZShcInBhc3RcIiwgaSA8IGN1cnJlbnREYXkpO1xuICAgICAgICBkYXkuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiLCBpID09PSBjdXJyZW50RGF5KTtcbiAgICB9KVxufVxuXG4vLyBmdW5jdGlvbiBhZGRBbmltYXRpb25DbGFzcygpIHtcbi8vICAgICBjb25zdCBwYXN0QW5kQWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi53aGVlbF9fZGF5cy1pdGVtLnBhc3QsIC53aGVlbF9fZGF5cy1pdGVtLmFjdGl2ZVwiKTtcbi8vICAgICBjb25zb2xlLmxvZyhwYXN0QW5kQWN0aXZlKVxuLy9cbi8vICAgICBwYXN0QW5kQWN0aXZlLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcbi8vICAgICAgICAgbGV0IGRheSA9IGl0ZW0ucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fZGF5cy1pdGVtLXRleHRcIilcbi8vICAgICAgICAgY29uc3QgcmFuZG9tRGVsYXkgPSBNYXRoLnJhbmRvbSgpICogMjAwMDA7XG4vL1xuLy8gICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbi8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRheSlcbi8vICAgICAgICAgICAgIGRheS5zdHlsZS5hbmltYXRpb25EZWxheSA9IGAke2kvIDJ9c2A7XG4vLyAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LmFkZCgnZGF5c0FuaW0nKTtcbi8vICAgICAgICAgICAgIGRheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4vLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF5KVxuLy8gICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QucmVtb3ZlKCdkYXlzQW5pbScpO1xuLy8gICAgICAgICAgICAgfSwge29uY2U6IHRydWV9KVxuLy8gICAgICAgICB9LCByYW5kb21EZWxheSk7XG4vLyAgICAgfSk7XG4vLyB9XG5cblxuXG5zZXREYXlzKGRheXMsIGN1cnJlbnREYXkpXG5zZXREYXlzKHBvcHVwRGF5cywgY3VycmVudERheSlcbnNldERheXMocG9wdXBEYXlzTW9iLCBjdXJyZW50RGF5KVxuLy8gYWRkQW5pbWF0aW9uQ2xhc3MoKVxuXG4vLy8gd2hlZWwgbG9naWNcbmNvbnN0IHdoZWVsU2VjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoZWVsX19zZWN0aW9uc1wiKVxuY29uc3Qgd2hlZWxXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fd3JhcFwiKVxuY29uc3Qgd2hlZWxBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2Fycm93XCIpXG5jb25zdCB3aGVlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2J0blwiKVxuY29uc3Qgc3BpbkJnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zcGluLWJnXCIpXG5jb25zdCBzYWx1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmlyZXdvcmtzLXdyYXBcIilcbmNvbnN0IGJ1YmxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fZGF5cy1pY29uc1wiKVxuY29uc3Qgd2hlZWxCdWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2J1YmxlXCIpXG5jb25zdCBwb3B1cENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBzXCIpXG5jb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBcIilcbmNvbnN0IHBvcHVwQ2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKVxuXG5idWJsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+e1xuICAgIHdoZWVsQnVibGUuY2xhc3NMaXN0LnRvZ2dsZShcIl9oaWRkZW5cIilcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtpZihlLnRhcmdldCAhPT0gYnVibGVCdG4pIHdoZWVsQnVibGUuY2xhc3NMaXN0LmFkZChcIl9oaWRkZW5cIil9KVxufSlcblxubGV0IHByaXplcyA9IFsnaXBob25lJywgJ2Vjb2Zsb3cnLCAnbWVyY2gnLCAnbm90aGluZycsIFwiYm9udXNlc1wiXVxuZnVuY3Rpb24gZ2V0UmFuZG9tUHJpemUoYXJyKSB7XG4gICAgcmV0dXJuIGFycltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwcml6ZXMubGVuZ3RoKV07XG59XG5mdW5jdGlvbiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLCBzaG93Q2xhc3MsIGN1cnJlbnREYXksIHNwaW5CZywgY2xvc2VCdG4sIHBvcHVwQ29udGFpbmVyLCBwb3B1cCl7XG4gICAgcG9wdXAuY2xhc3NMaXN0LmFkZChgJHtzaG93Q2xhc3N9YClcbiAgICBjdXJyZW50RGF5ID09PSA3ID8gcG9wdXAuY2xhc3NMaXN0LmFkZChcIl9kb25lXCIpIDogcG9wdXAuY2xhc3NMaXN0LmFkZChcIl9pbmNvbXBsZXRlXCIpXG4gICAgcG9wdXBDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIl9vcGFjaXR5XCIsIFwiX3pJbmRleFwiKVxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiXG4gICAgc3BpbkJnLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93U3BpbkJnXCIpXG4gICAgY29uc3QgcGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX3BlcnNcIilcbiAgICBjb25zdCBwcml6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX3ByaXplXCIpXG4gICAgY29uc3QgYnVibGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19idWJsZVwiKVxuICAgIGNvbnN0IHBvcHVwQm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX21haW5cIilcbiAgICBjb25zdCBwb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fdGl0bGVcIilcbiAgICBjb25zdCBwb3B1cExlZnRBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2RlY29yLWxlZnRcIilcbiAgICBjb25zdCBwb3B1cFJpZ2h0QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19kZWNvci1yaWdodFwiKVxuICAgIGN1cnJlbnREYXkgPT09IDcgPyBwb3B1cEJvZHkuY2xhc3NMaXN0LmFkZChcIl9kb25lXCIpIDogcG9wdXAuY2xhc3NMaXN0LmFkZChcIl9pbmNvbXBsZXRlXCIpXG5cbiAgICBmdW5jdGlvbiBhZGRBbmltKGFyciwgY2xhc3NBbmltKXtcbiAgICAgICAgYXJyLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoYCR7Y2xhc3NBbmltfWApIClcbiAgICB9XG5cbiAgICAvL3BvcHVwIGFuaW1hdGlvbnNcbiAgICBwb3B1cEJvZHkuY2xhc3NMaXN0LmFkZChcInBvcHVwTWFpbkFuaW1cIilcbiAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICBhZGRBbmltKHBlcnMsIFwicG9wdXBQZXJzQW5pbVwiKVxuICAgICAgICBhZGRBbmltKGJ1YmxlLCBcInBvcHVwQnVibGVBbmltXCIpXG4gICAgfSwgNjAwKVxuICAgIHNldFRpbWVvdXQoICgpID0+IGFkZEFuaW0ocHJpemUsIFwicG9wdXBQcml6ZUFuaW1cIiksIDEyMDApXG4gICAgc2V0VGltZW91dCggKCkgPT4gcG9wdXBUaXRsZS5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QuYWRkKFwicG9wdXBUaXRsZUFuaW1cIikpLCAxODAwKVxuICAgIHNldFRpbWVvdXQoICgpID0+IHBvcHVwTGVmdEFycm93LmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJwb3B1cExlZnRBcnJBbmltXCIpKSwgMjQwMClcbiAgICBzZXRUaW1lb3V0KCAoKSA9PiBwb3B1cFJpZ2h0QXJyb3cuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LmFkZChcInBvcHVwUmlnaHRBcnJBbmltXCIpKSwgMjcwMClcblxuICAgIC8vcG9wdXAgYW5pbWF0aW9uc1xuXG5cbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgICAgIHdoZWVsLmNsYXNzTGlzdC5hZGQoXCJfbG9ja1wiKVxuICAgICAgICB3aGVlbC5jbGFzc0xpc3QucmVtb3ZlKFwid2hlZWxTaXplSW5jcmVhc2VcIilcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiYXV0b1wiXG4gICAgICAgIHBvcHVwQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJfb3BhY2l0eVwiLCBcIl96SW5kZXhcIilcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShgJHtzaG93Q2xhc3N9YCwgJ19kb25lJywgJ19pbmNvbXBsZXRlJylcbiAgICB9KVxufVxuZnVuY3Rpb24gc3BpbldoZWVsKHBvc2l0aW9uLCBhbmltYXRpb24sIHNlY3Rpb25zLCBidG4sIHdoZWVsLCBhcnJvdywgcHJpemUsIHNwaW5CZywgc2FsdXQpe1xuICAgIHNlY3Rpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgKCkgPT57XG4gICAgICAgIHNlY3Rpb25zLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKCR7cG9zaXRpb259ZGVnKWBcbiAgICAgICAgY29uc29sZS5sb2cocHJpemUpXG4gICAgfSwge29uY2U6IHRydWV9KVxuICAgIHNlY3Rpb25zLmNsYXNzTGlzdC5hZGQoYCR7YW5pbWF0aW9ufWApXG4gICAgYXJyb3cuc3R5bGUub3BhY2l0eSA9IFwiMFwiXG4gICAgd2hlZWwuY2xhc3NMaXN0LmFkZChcIndoZWVsU2l6ZUluY3JlYXNlXCIpXG4gICAgc3BpbkJnLmNsYXNzTGlzdC5hZGQoXCJzaG93U3BpbkJnXCIpXG4gICAgc2FsdXQuY2xhc3NMaXN0LmFkZChcIl9vcGFjaXR5XCIpXG4gICAgYnRuLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxufVxuXG5mdW5jdGlvbiBmaXJzdFNwaW4oc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dCl7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICAgICAgaWYocHJpemUgPT09IFwiaXBob25lXCIpe1xuICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLCBcIl9pcGhvbmVcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgc3BpbldoZWVsKDE4MDAsIFwiaXBob25lUHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgfVxuICAgICAgICBpZihwcml6ZSA9PT0gXCJlY29mbG93XCIpe1xuICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLCBcIl9lY29mbG93XCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgIHNwaW5XaGVlbCgxNjY1LCBcImVjb2Zsb3dQcml6ZVwiLCBzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KVxuICAgICAgICB9XG4gICAgICAgIGlmKHByaXplID09PSBcIm1lcmNoXCIpe1xuICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLCBcIl9tZXJjaFwiLCBjdXJyZW50RGF5LCBzcGluQmcsIHBvcHVwQ2xvc2VCdG4sIHBvcHVwQ29udGFpbmVyLCBwb3B1cCkpXG4gICAgICAgICAgICBzcGluV2hlZWwoMTcxMSwgXCJtZXJjaFByaXplXCIsIHNlY3Rpb25zLCBidG4sIHdoZWVsLCBhcnJvdywgcHJpemUsIHNwaW5CZywgc2FsdXQpXG4gICAgICAgIH1cbiAgICAgICAgaWYocHJpemUgPT09IFwibm90aGluZ1wiKXtcbiAgICAgICAgICAgIHNlY3Rpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgKCkgPT4gc2hvd1BvcHVwKHNlY3Rpb25zLCB3aGVlbCxcIl9ub3RoaW5nXCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgIHNwaW5XaGVlbCgxNzU1LCBcIm5vdGhpbmdQcml6ZVwiLCBzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KVxuICAgICAgICB9XG4gICAgICAgIGlmKHByaXplID09PSBcImJvbnVzZXNcIil7XG4gICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX2JvbnVzXCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgIHNwaW5XaGVlbCgxOTM1LCBcImJvbnVzZXNQcml6ZVwiLCBzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZmlyc3RTcGluKHdoZWVsU2VjdGlvbnMsIHdoZWVsQnRuLCB3aGVlbFdyYXAsIHdoZWVsQXJyb3csIFwiZWNvZmxvd1wiLCBzcGluQmcsIHNhbHV0KVxuXG5cblxuXG5cblxuLy8vLyBhY2NvcmRpb25cblxuY29uc3QgYWNjb3JkaW9uSGVhZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hY2NvcmRpb25fX2hlYWRlcicpO1xuYWNjb3JkaW9uSGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XG4gICAgaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gaGVhZGVyLm5leHRFbGVtZW50U2libGluZztcblxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWNjb3JkaW9uX19jb250ZW50JykuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChpdGVtICE9PSBjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY29udGVudC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG5cbi8vLy8gZm9yIHRlc3RcblxuY29uc3QgYnRuc1dyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRucy13cmFwJyk7XG5cbmNvbnN0IGJ1dHRvbnMgPSBidG5zV3JhcC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKTtcblxuY29uc3QgZHJvcElwaG9uZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kcm9wLWlwaG9uZScpO1xuY29uc3QgZHJvcEVjb2Zsb3dCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1lY29mbG93Jyk7XG5jb25zdCBkcm9wTm90aGluZ0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kcm9wLW5vdGhpbmcnKTtcbmNvbnN0IGRyb3BNZXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kcm9wLW1lcmNoJyk7XG5jb25zdCBkcm9wQm9udXNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1ib251cycpO1xuY29uc3QgZHJvcERvbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJvcC1kb25lJyk7XG4vLyBjb25zdCBkcm9wSW5jb21wbGV0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kcm9wLWluY29tcGxldGUnKTtcbmNvbnN0IGRyb3BNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyb3AtbWVudScpO1xuXG5kcm9wTWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCk9PiBidG5zV3JhcC5jbGFzc0xpc3QudG9nZ2xlKFwiX2hpZGRlblwiKSlcblxuZmlyc3RTcGluKHdoZWVsU2VjdGlvbnMsIGRyb3BJcGhvbmVCdXR0b24sIHdoZWVsV3JhcCwgd2hlZWxBcnJvdywgXCJpcGhvbmVcIiwgc3BpbkJnLCBzYWx1dClcbmZpcnN0U3Bpbih3aGVlbFNlY3Rpb25zLCBkcm9wRWNvZmxvd0J1dHRvbiwgd2hlZWxXcmFwLCB3aGVlbEFycm93LCBcImVjb2Zsb3dcIiwgc3BpbkJnLCBzYWx1dClcbmZpcnN0U3Bpbih3aGVlbFNlY3Rpb25zLCBkcm9wTm90aGluZ0J1dHRvbiwgd2hlZWxXcmFwLCB3aGVlbEFycm93LCBcIm5vdGhpbmdcIiwgc3BpbkJnLCBzYWx1dClcbmZpcnN0U3Bpbih3aGVlbFNlY3Rpb25zLCBkcm9wTWVyY2hCdXR0b24sIHdoZWVsV3JhcCwgd2hlZWxBcnJvdywgXCJtZXJjaFwiLCBzcGluQmcsIHNhbHV0KVxuZmlyc3RTcGluKHdoZWVsU2VjdGlvbnMsIGRyb3BCb251c0J1dHRvbiwgd2hlZWxXcmFwLCB3aGVlbEFycm93LCBcImJvbnVzZXNcIiwgc3BpbkJnLCBzYWx1dClcblxuYnV0dG9ucy5mb3JFYWNoKGl0ZW0gPT57XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB3aGVlbFNlY3Rpb25zLnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uID0gXCIwLjFzXCJcbiAgICAgICAgd2hlZWxTZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+e1xuICAgICAgICAgICAgd2hlZWxTZWN0aW9ucy5zdHlsZS5hbmltYXRpb25EdXJhdGlvbiA9IFwiOHNcIlxuICAgICAgICB9KVxuICAgIH0pXG59KVxuXG5kcm9wRG9uZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY3VycmVudERheSA9IDcpXG4vLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjdXJyZW50RGF5LCBjdXJyZW50RGF5KVxuLy8gZHJvcEluY29tcGxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGN1cnJlbnREYXkgPSAzKVxuXG5cblxuIl19
