"use strict";

var days = document.querySelectorAll(".wheel__days-item");
var popupDays = document.querySelectorAll(".popup__days-item");
var currentDay = 4;
function setDays(days, currentDay) {
  days.forEach(function (day, i) {
    ++i;
    day.classList.toggle("next", i > currentDay);
    day.classList.toggle("past", i < currentDay);
    day.classList.toggle("active", i === currentDay);
  });
}

// function addAnimationClass() {
//     const pastAndActive = document.querySelectorAll(".wheel__days-item.past, .wheel__days-item.active");
//     console.log(pastAndActive)
//
//     pastAndActive.forEach((item, i) => {
//         let day = item.querySelector(".wheel__days-item-text")
//         const randomDelay = Math.random() * 20000;
//
//         setTimeout(() => {
//             // console.log(day)
//             day.style.animationDelay = `${i/ 2}s`;
//             day.classList.add('daysAnim');
//             day.addEventListener("click", () =>{
//                 console.log(day)
//                 day.classList.remove('daysAnim');
//             }, {once: true})
//         }, randomDelay);
//     });
// }

setDays(days, currentDay);
setDays(popupDays, currentDay);
// addAnimationClass()

/// wheel logic
var wheelSections = document.querySelector(".wheel__sections");
var wheelWrap = document.querySelector(".wheel__wrap");
var wheelArrow = document.querySelector(".wheel__arrow");
var wheelBtn = document.querySelector(".wheel__btn");
var spinBg = document.querySelector(".spin-bg");
var salut = document.querySelector(".fireworks-wrap");
var bubleBtn = document.querySelector(".wheel__days-icons");
var wheelBuble = document.querySelector(".wheel__buble");
var popupContainer = document.querySelector(".popups");
var popup = document.querySelector(".popup");
var popupCloseBtn = document.querySelector(".popup__close");
bubleBtn.addEventListener("click", function (e) {
  wheelBuble.classList.toggle("_hidden");
  document.addEventListener("click", function (e) {
    if (e.target !== bubleBtn) wheelBuble.classList.add("_hidden");
  });
});
var prizes = ['iphone', 'ecoflow', 'merch', 'nothing', "bonuses"];
function getRandomPrize(arr) {
  return arr[Math.floor(Math.random() * prizes.length)];
}
function showPopup(sections, wheel, showClass, currentDay, spinBg, closeBtn, popupContainer, popup) {
  popup.classList.add("".concat(showClass));
  currentDay === 7 ? popup.classList.add("_done") : popup.classList.add("_incomplete");
  popupContainer.classList.add("_opacity", "_zIndex");
  document.body.style.overflow = "hidden";
  spinBg.classList.remove("showSpinBg");
  var pers = document.querySelectorAll(".popup__pers");
  var prize = document.querySelectorAll(".popup__prize");
  var buble = document.querySelectorAll(".popup__buble");
  var popupBody = document.querySelector(".popup__main");
  var popupTitle = document.querySelector(".popup__title");
  var popupLeftArrow = document.querySelector(".popup__decor-left");
  var popupRightArrow = document.querySelector(".popup__decor-right");
  function addAnim(arr, classAnim) {
    arr.forEach(function (item) {
      return item.classList.add("".concat(classAnim));
    });
  }
  popupBody.classList.add("popupMainAnim");
  setTimeout(function () {
    addAnim(pers, "popupPersAnim");
    addAnim(buble, "popupBubleAnim");
  }, 600);
  setTimeout(function () {
    return addAnim(prize, "popupPrizeAnim");
  }, 1200);
  setTimeout(function () {
    return popupTitle.classList.add("popupTitleAnim");
  }, 1800);
  setTimeout(function () {
    return popupLeftArrow.classList.add("popupLeftArrAnim");
  }, 2400);
  setTimeout(function () {
    return popupRightArrow.classList.add("popupRightArrAnim");
  }, 2700);
  closeBtn.addEventListener("click", function () {
    wheel.classList.add("_lock");
    wheel.style.transform = "scale(1)";
    document.body.style.overflow = "auto";
    popupContainer.classList.remove("_opacity", "_zIndex");
    popup.classList.remove("".concat(showClass), '_done', '_incomplete');
  });
}
function spinWheel(position, animation, sections, btn, wheel, arrow, prize, spinBg, salut) {
  sections.addEventListener("animationend", function () {
    sections.style.transform = "translate(-50%, -50%) rotate(".concat(position, "deg)");
    console.log(prize);
  }, {
    once: true
  });
  sections.classList.add("".concat(animation));
  arrow.style.opacity = "0";
  wheel.classList.add("wheelSizeIncrease");
  spinBg.classList.add("showSpinBg");
  salut.classList.add("_opacity");
  btn.style.pointerEvents = "none";
}
function firstSpin(sections, btn, wheel, arrow, prize, spinBg, salut) {
  btn.addEventListener("click", function () {
    if (prize === "iphone") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_iphone", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1800, "iphonePrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "ecoflow") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_ecoflow", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1665, "ecoflowPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "merch") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_merch", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1711, "merchPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "nothing") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_nothing", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1755, "nothingPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
    if (prize === "bonuses") {
      sections.addEventListener("animationend", function () {
        return showPopup(sections, wheel, "_bonus", currentDay, spinBg, popupCloseBtn, popupContainer, popup);
      });
      spinWheel(1935, "bonusesPrize", sections, btn, wheel, arrow, prize, spinBg, salut);
    }
  });
}
firstSpin(wheelSections, wheelBtn, wheelWrap, wheelArrow, "iphone", spinBg, salut);

// getRandomPrize(prizes)

//// accordion

var accordionHeaders = document.querySelectorAll('.accordion-header');
accordionHeaders.forEach(function (header) {
  header.addEventListener('click', function () {
    var content = header.nextElementSibling;
    document.querySelectorAll('.accordion-content').forEach(function (item) {
      if (item !== content) {
        item.style.display = 'none';
        item.previousElementSibling.classList.remove('open');
      }
    });
    if (content.style.display === 'block') {
      content.style.display = 'none';
      header.classList.remove('open');
    } else {
      content.style.display = 'block';
      header.classList.add('open');
    }
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZGF5cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInBvcHVwRGF5cyIsImN1cnJlbnREYXkiLCJzZXREYXlzIiwiZm9yRWFjaCIsImRheSIsImkiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJ3aGVlbFNlY3Rpb25zIiwicXVlcnlTZWxlY3RvciIsIndoZWVsV3JhcCIsIndoZWVsQXJyb3ciLCJ3aGVlbEJ0biIsInNwaW5CZyIsInNhbHV0IiwiYnVibGVCdG4iLCJ3aGVlbEJ1YmxlIiwicG9wdXBDb250YWluZXIiLCJwb3B1cCIsInBvcHVwQ2xvc2VCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsImFkZCIsInByaXplcyIsImdldFJhbmRvbVByaXplIiwiYXJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwic2hvd1BvcHVwIiwic2VjdGlvbnMiLCJ3aGVlbCIsInNob3dDbGFzcyIsImNsb3NlQnRuIiwiYm9keSIsInN0eWxlIiwib3ZlcmZsb3ciLCJyZW1vdmUiLCJwZXJzIiwicHJpemUiLCJidWJsZSIsInBvcHVwQm9keSIsInBvcHVwVGl0bGUiLCJwb3B1cExlZnRBcnJvdyIsInBvcHVwUmlnaHRBcnJvdyIsImFkZEFuaW0iLCJjbGFzc0FuaW0iLCJpdGVtIiwic2V0VGltZW91dCIsInRyYW5zZm9ybSIsInNwaW5XaGVlbCIsInBvc2l0aW9uIiwiYW5pbWF0aW9uIiwiYnRuIiwiYXJyb3ciLCJjb25zb2xlIiwibG9nIiwib25jZSIsIm9wYWNpdHkiLCJwb2ludGVyRXZlbnRzIiwiZmlyc3RTcGluIiwiYWNjb3JkaW9uSGVhZGVycyIsImhlYWRlciIsImNvbnRlbnQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJkaXNwbGF5IiwicHJldmlvdXNFbGVtZW50U2libGluZyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxJQUFJLEdBQUdDLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMs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TUFBTSxDQUFDRSxrQkFBa0I7SUFFekNwRSxRQUFRLENBQUNDLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLENBQUNJLE9BQU8sQ0FBQyxVQUFBOEMsSUFBSSxFQUFJO01BQzVELElBQUlBLElBQUksS0FBS2dCLE9BQU8sRUFBRTtRQUNsQmhCLElBQUksQ0FBQ1osS0FBSyxDQUFDOEIsT0FBTyxHQUFHLE1BQU07UUFDM0JsQixJQUFJLENBQUNtQixzQkFBc0IsQ0FBQzlELFNBQVMsQ0FBQ2lDLE1BQU0sQ0FBQyxNQUFNLENBQUM7TUFDeEQ7SUFDSixDQUFDLENBQUM7SUFDRixJQUFJMEIsT0FBTyxDQUFDNUIsS0FBSyxDQUFDOEIsT0FBTyxLQUFLLE9BQU8sRUFBRTtNQUNuQ0YsT0FBTyxDQUFDNUIsS0FBSyxDQUFDOEIsT0FBTyxHQUFHLE1BQU07TUFDOUJILE1BQU0sQ0FBQzFELFNBQVMsQ0FBQ2lDLE1BQU0sQ0FBQyxNQUFNLENBQUM7SUFDbkMsQ0FBQyxNQUFNO01BQ0gwQixPQUFPLENBQUM1QixLQUFLLENBQUM4QixPQUFPLEdBQUcsT0FBTztNQUMvQkgsTUFBTSxDQUFDMUQsU0FBUyxDQUFDaUIsR0FBRyxDQUFDLE1BQU0sQ0FBQztJQUNoQztFQUNKLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGF5cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIud2hlZWxfX2RheXMtaXRlbVwiKVxuY29uc3QgcG9wdXBEYXlzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZGF5cy1pdGVtXCIpO1xubGV0IGN1cnJlbnREYXkgPSA0XG5cbmZ1bmN0aW9uIHNldERheXMoZGF5cywgY3VycmVudERheSl7XG4gICAgZGF5cy5mb3JFYWNoKChkYXksIGkpID0+e1xuICAgICAgICArK2lcbiAgICAgICAgZGF5LmNsYXNzTGlzdC50b2dnbGUoXCJuZXh0XCIsIGkgPiBjdXJyZW50RGF5KTtcbiAgICAgICAgZGF5LmNsYXNzTGlzdC50b2dnbGUoXCJwYXN0XCIsIGkgPCBjdXJyZW50RGF5KTtcbiAgICAgICAgZGF5LmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIiwgaSA9PT0gY3VycmVudERheSk7XG4gICAgfSlcbn1cblxuLy8gZnVuY3Rpb24gYWRkQW5pbWF0aW9uQ2xhc3MoKSB7XG4vLyAgICAgY29uc3QgcGFzdEFuZEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIud2hlZWxfX2RheXMtaXRlbS5wYXN0LCAud2hlZWxfX2RheXMtaXRlbS5hY3RpdmVcIik7XG4vLyAgICAgY29uc29sZS5sb2cocGFzdEFuZEFjdGl2ZSlcbi8vXG4vLyAgICAgcGFzdEFuZEFjdGl2ZS5mb3JFYWNoKChpdGVtLCBpKSA9PiB7XG4vLyAgICAgICAgIGxldCBkYXkgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX2RheXMtaXRlbS10ZXh0XCIpXG4vLyAgICAgICAgIGNvbnN0IHJhbmRvbURlbGF5ID0gTWF0aC5yYW5kb20oKSAqIDIwMDAwO1xuLy9cbi8vICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4vLyAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXkpXG4vLyAgICAgICAgICAgICBkYXkuc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBgJHtpLyAyfXNgO1xuLy8gICAgICAgICAgICAgZGF5LmNsYXNzTGlzdC5hZGQoJ2RheXNBbmltJyk7XG4vLyAgICAgICAgICAgICBkYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+e1xuLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRheSlcbi8vICAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LnJlbW92ZSgnZGF5c0FuaW0nKTtcbi8vICAgICAgICAgICAgIH0sIHtvbmNlOiB0cnVlfSlcbi8vICAgICAgICAgfSwgcmFuZG9tRGVsYXkpO1xuLy8gICAgIH0pO1xuLy8gfVxuXG5cblxuc2V0RGF5cyhkYXlzLCBjdXJyZW50RGF5KVxuc2V0RGF5cyhwb3B1cERheXMsIGN1cnJlbnREYXkpXG4vLyBhZGRBbmltYXRpb25DbGFzcygpXG5cbi8vLyB3aGVlbCBsb2dpY1xuY29uc3Qgd2hlZWxTZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2hlZWxfX3NlY3Rpb25zXCIpXG5jb25zdCB3aGVlbFdyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoZWVsX193cmFwXCIpXG5jb25zdCB3aGVlbEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fYXJyb3dcIilcbmNvbnN0IHdoZWVsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fYnRuXCIpXG5jb25zdCBzcGluQmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNwaW4tYmdcIilcbmNvbnN0IHNhbHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5maXJld29ya3Mtd3JhcFwiKVxuY29uc3QgYnVibGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndoZWVsX19kYXlzLWljb25zXCIpXG5jb25zdCB3aGVlbEJ1YmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGVlbF9fYnVibGVcIilcbmNvbnN0IHBvcHVwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cHNcIilcbmNvbnN0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cFwiKVxuY29uc3QgcG9wdXBDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpXG5cbmJ1YmxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT57XG4gICAgd2hlZWxCdWJsZS5jbGFzc0xpc3QudG9nZ2xlKFwiX2hpZGRlblwiKVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge2lmKGUudGFyZ2V0ICE9PSBidWJsZUJ0bikgd2hlZWxCdWJsZS5jbGFzc0xpc3QuYWRkKFwiX2hpZGRlblwiKX0pXG59KVxuXG5sZXQgcHJpemVzID0gWydpcGhvbmUnLCAnZWNvZmxvdycsICdtZXJjaCcsICdub3RoaW5nJywgXCJib251c2VzXCJdXG5mdW5jdGlvbiBnZXRSYW5kb21Qcml6ZShhcnIpIHtcbiAgICByZXR1cm4gYXJyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHByaXplcy5sZW5ndGgpXTtcbn1cbmZ1bmN0aW9uIHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIHNob3dDbGFzcywgY3VycmVudERheSwgc3BpbkJnLCBjbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKXtcbiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKGAke3Nob3dDbGFzc31gKVxuICAgIGN1cnJlbnREYXkgPT09IDcgPyBwb3B1cC5jbGFzc0xpc3QuYWRkKFwiX2RvbmVcIikgOiBwb3B1cC5jbGFzc0xpc3QuYWRkKFwiX2luY29tcGxldGVcIilcbiAgICBwb3B1cENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiX29wYWNpdHlcIiwgXCJfekluZGV4XCIpXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCJcbiAgICBzcGluQmcuY2xhc3NMaXN0LnJlbW92ZShcInNob3dTcGluQmdcIilcbiAgICBjb25zdCBwZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fcGVyc1wiKVxuICAgIGNvbnN0IHByaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fcHJpemVcIilcbiAgICBjb25zdCBidWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2J1YmxlXCIpXG4gICAgY29uc3QgcG9wdXBCb2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fbWFpblwiKVxuICAgIGNvbnN0IHBvcHVwVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX190aXRsZVwiKVxuICAgIGNvbnN0IHBvcHVwTGVmdEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZGVjb3ItbGVmdFwiKVxuICAgIGNvbnN0IHBvcHVwUmlnaHRBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2RlY29yLXJpZ2h0XCIpXG4gICAgZnVuY3Rpb24gYWRkQW5pbShhcnIsIGNsYXNzQW5pbSl7XG4gICAgICAgIGFyci5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QuYWRkKGAke2NsYXNzQW5pbX1gKSApXG4gICAgfVxuXG5cbiAgICBwb3B1cEJvZHkuY2xhc3NMaXN0LmFkZChcInBvcHVwTWFpbkFuaW1cIilcbiAgICBzZXRUaW1lb3V0KCgpID0+e1xuICAgICAgICBhZGRBbmltKHBlcnMsIFwicG9wdXBQZXJzQW5pbVwiKVxuICAgICAgICBhZGRBbmltKGJ1YmxlLCBcInBvcHVwQnVibGVBbmltXCIpXG4gICAgfSwgNjAwKVxuICAgIHNldFRpbWVvdXQoICgpID0+IGFkZEFuaW0ocHJpemUsIFwicG9wdXBQcml6ZUFuaW1cIiksIDEyMDApXG4gICAgc2V0VGltZW91dCggKCkgPT4gcG9wdXBUaXRsZS5jbGFzc0xpc3QuYWRkKFwicG9wdXBUaXRsZUFuaW1cIiksIDE4MDApXG4gICAgc2V0VGltZW91dCggKCkgPT4gcG9wdXBMZWZ0QXJyb3cuY2xhc3NMaXN0LmFkZChcInBvcHVwTGVmdEFyckFuaW1cIiksIDI0MDApXG4gICAgc2V0VGltZW91dCggKCkgPT4gcG9wdXBSaWdodEFycm93LmNsYXNzTGlzdC5hZGQoXCJwb3B1cFJpZ2h0QXJyQW5pbVwiKSwgMjcwMClcblxuICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICAgICAgd2hlZWwuY2xhc3NMaXN0LmFkZChcIl9sb2NrXCIpXG4gICAgICAgIHdoZWVsLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoMSlcIlxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCJcbiAgICAgICAgcG9wdXBDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIl9vcGFjaXR5XCIsIFwiX3pJbmRleFwiKVxuICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKGAke3Nob3dDbGFzc31gLCAnX2RvbmUnLCAnX2luY29tcGxldGUnKVxuICAgIH0pXG59XG5mdW5jdGlvbiBzcGluV2hlZWwocG9zaXRpb24sIGFuaW1hdGlvbiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dCl7XG4gICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PntcbiAgICAgICAgc2VjdGlvbnMuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSByb3RhdGUoJHtwb3NpdGlvbn1kZWcpYFxuICAgICAgICBjb25zb2xlLmxvZyhwcml6ZSlcbiAgICB9LCB7b25jZTogdHJ1ZX0pXG4gICAgc2VjdGlvbnMuY2xhc3NMaXN0LmFkZChgJHthbmltYXRpb259YClcbiAgICBhcnJvdy5zdHlsZS5vcGFjaXR5ID0gXCIwXCJcbiAgICB3aGVlbC5jbGFzc0xpc3QuYWRkKFwid2hlZWxTaXplSW5jcmVhc2VcIilcbiAgICBzcGluQmcuY2xhc3NMaXN0LmFkZChcInNob3dTcGluQmdcIilcbiAgICBzYWx1dC5jbGFzc0xpc3QuYWRkKFwiX29wYWNpdHlcIilcbiAgICBidG4uc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiXG59XG5cbmZ1bmN0aW9uIGZpcnN0U3BpbihzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KXtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+e1xuICAgICAgICBpZihwcml6ZSA9PT0gXCJpcGhvbmVcIil7XG4gICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX2lwaG9uZVwiLCBjdXJyZW50RGF5LCBzcGluQmcsIHBvcHVwQ2xvc2VCdG4sIHBvcHVwQ29udGFpbmVyLCBwb3B1cCkpXG4gICAgICAgICAgICBzcGluV2hlZWwoMTgwMCwgXCJpcGhvbmVQcml6ZVwiLCBzZWN0aW9ucywgYnRuLCB3aGVlbCwgYXJyb3csIHByaXplLCBzcGluQmcsIHNhbHV0KVxuICAgICAgICB9XG4gICAgICAgIGlmKHByaXplID09PSBcImVjb2Zsb3dcIil7XG4gICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX2Vjb2Zsb3dcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgc3BpbldoZWVsKDE2NjUsIFwiZWNvZmxvd1ByaXplXCIsIHNlY3Rpb25zLCBidG4sIHdoZWVsLCBhcnJvdywgcHJpemUsIHNwaW5CZywgc2FsdXQpXG4gICAgICAgIH1cbiAgICAgICAgaWYocHJpemUgPT09IFwibWVyY2hcIil7XG4gICAgICAgICAgICBzZWN0aW9ucy5hZGRFdmVudExpc3RlbmVyKFwiYW5pbWF0aW9uZW5kXCIsICgpID0+IHNob3dQb3B1cChzZWN0aW9ucywgd2hlZWwsIFwiX21lcmNoXCIsIGN1cnJlbnREYXksIHNwaW5CZywgcG9wdXBDbG9zZUJ0biwgcG9wdXBDb250YWluZXIsIHBvcHVwKSlcbiAgICAgICAgICAgIHNwaW5XaGVlbCgxNzExLCBcIm1lcmNoUHJpemVcIiwgc2VjdGlvbnMsIGJ0biwgd2hlZWwsIGFycm93LCBwcml6ZSwgc3BpbkJnLCBzYWx1dClcbiAgICAgICAgfVxuICAgICAgICBpZihwcml6ZSA9PT0gXCJub3RoaW5nXCIpe1xuICAgICAgICAgICAgc2VjdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoKSA9PiBzaG93UG9wdXAoc2VjdGlvbnMsIHdoZWVsLFwiX25vdGhpbmdcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgc3BpbldoZWVsKDE3NTUsIFwibm90aGluZ1ByaXplXCIsIHNlY3Rpb25zLCBidG4sIHdoZWVsLCBhcnJvdywgcHJpemUsIHNwaW5CZywgc2FsdXQpXG4gICAgICAgIH1cbiAgICAgICAgaWYocHJpemUgPT09IFwiYm9udXNlc1wiKXtcbiAgICAgICAgICAgIHNlY3Rpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgKCkgPT4gc2hvd1BvcHVwKHNlY3Rpb25zLCB3aGVlbCwgXCJfYm9udXNcIiwgY3VycmVudERheSwgc3BpbkJnLCBwb3B1cENsb3NlQnRuLCBwb3B1cENvbnRhaW5lciwgcG9wdXApKVxuICAgICAgICAgICAgc3BpbldoZWVsKDE5MzUsIFwiYm9udXNlc1ByaXplXCIsIHNlY3Rpb25zLCBidG4sIHdoZWVsLCBhcnJvdywgcHJpemUsIHNwaW5CZywgc2FsdXQpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5maXJzdFNwaW4od2hlZWxTZWN0aW9ucywgd2hlZWxCdG4sIHdoZWVsV3JhcCwgd2hlZWxBcnJvdywgXCJpcGhvbmVcIiwgc3BpbkJnLCBzYWx1dClcblxuXG5cbi8vIGdldFJhbmRvbVByaXplKHByaXplcylcblxuXG4vLy8vIGFjY29yZGlvblxuXG5jb25zdCBhY2NvcmRpb25IZWFkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFjY29yZGlvbi1oZWFkZXInKTtcbmFjY29yZGlvbkhlYWRlcnMuZm9yRWFjaChoZWFkZXIgPT4ge1xuICAgIGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGhlYWRlci5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFjY29yZGlvbi1jb250ZW50JykuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChpdGVtICE9PSBjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZy5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY29udGVudC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgICBjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG5cbiJdfQ==
